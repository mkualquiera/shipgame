<!DOCTYPE html>
<html>
    <head>
        <title>WebSocket demo</title>
    </head>
    <body>
        <input type="range" min="0" max="360", value="90" class="slider" 
            oninput="" id="heading_s">
        <div id="heading">
            90
        </div>
        <script>
            var ws = new WebSocket("ws://127.0.0.1:5678/"),
                heading = document.getElementById('heading');
            var slider = document.getElementById('heading_s')
            slider.oninput = function() {
                set_heading(slider.value)
            }
            ws.onopen = function (event) {
                ws.send(JSON.stringify({type:"SUB",path:"ship/desired_heading",
                    payload:""}));
            }
            ws.onmessage = function (event) {
                var req_obj = JSON.parse(event.data);
                if (req_obj.type == "SET") {
                    console.debug(req_obj.payload)
                    heading.innerText = req_obj.payload;
                }
            };
            set_heading = function (heading) {
                ws.send(JSON.stringify({type:"SET",path:"ship/desired_heading",
                payload:heading}));
            }
        </script>
    </body>
</html>
